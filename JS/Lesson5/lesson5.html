<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      td {
        width: 20px;
        height: 30px;
      }
      table,
      tr,
      td {
        border: 1px solid black;
        border-collapse: collapse;
        padding-left: 10px;        
      }
    </style>
  </head>
  <body>
    <p id="turn">Lượt của:</p>
    <table>
      <tr>
        <td id="8"></td>
        <td id="1"></td>
        <td id="6"></td>
      </tr>
      <tr>
        <td id="3"</td>
        <td id="5"></td>
        <td id="7"></td>
      </tr>
      <tr>
        <td id="4"></td>
        <td id="9"></td>
        <td id="2"></td>
      </tr>
    </table>
    <p id = "winner">
        Người thắng là: 
    </p>
    <script>
      let turnX = true;
      const tds = document.querySelectorAll("td");
      const turnNode = document.createTextNode("X");
      const winnerNode = document.createTextNode("");
      let state = {};            
      document.getElementById("turn").append(turnNode);
            
      tds.forEach(function (td) {
        td.addEventListener(
          "click",
          function (e) {
            this.textContent = turnX ? "X" : "O";
            if (state[0]==state[1] && state[1]==state[2] && state[0]==this.textContent||
            state[3]==state[4] && state[4]==state[5]&& state[3]==this.textContent||
            state[6]==state[7] && state[7]==state[8]&& state[6]==this.textContent||
            state[0]==state[3] && state[3]==state[6]&& state[0]==this.textContent||
            state[1]==state[4] && state[4]==state[7]&& state[1]==this.textContent||
            state[2]==state[5] && state[5]==state[8]&& state[2]==this.textContent||
            state[0]==state[4] && state[4]==state[8]&& state[0]==this.textContent||
            state[2]==state[4] && state[4]==state[6]&& state[2]==this.textContent
            ){              
              winnerNode.textContent = turnX ? "X" : "O"; 
            } 
            state[parseInt(this.id)]=this.textContent;             
            console.log(state);   
            turnX = !turnX;
            turnNode.textContent = turnX ? "X" : "O";          
          },
          {
            once: true,
          }
        );
      });
      document.getElementById("winner").append(winnerNode);
    </script>
  </body>
</html>
